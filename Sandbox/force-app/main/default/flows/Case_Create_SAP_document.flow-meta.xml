<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Redirect_to_Sales_Order_Poster</name>
        <label>Redirect to Sales Order Poster</label>
        <locationX>534</locationX>
        <locationY>854</locationY>
        <actionName>c:OvcRedirectToSOPoster</actionName>
        <actionType>component</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>detailComponentName</name>
            <value>
                <elementReference>detailComponentName</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recordId</name>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>slpParamsDetailJSON</name>
            <value>
                <elementReference>slpParamsDetail</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>slpParamsJSON</name>
            <value>
                <elementReference>slpParamsPoster</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>mode</name>
            <value>
                <elementReference>posterMode</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>componentName</name>
            <value>
                <elementReference>ZOR_SALES_ORDER_POSTER</elementReference>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <apiVersion>54.0</apiVersion>
    <assignments>
        <name>Assign_params_for_poster</name>
        <label>Assign params for poster</label>
        <locationX>534</locationX>
        <locationY>398</locationY>
        <assignmentItems>
            <assignToReference>slpParamsPoster</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>{&quot;slpParams&quot;:{&quot;DOC_TYPE&quot;:&quot;{!selectedDocType}&quot;}}</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_selected_document_type</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_selected_document_type</name>
        <label>Assign selected document type</label>
        <locationX>534</locationX>
        <locationY>278</locationY>
        <assignmentItems>
            <assignToReference>selectedDocType</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>choose_document_type</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_params_for_poster</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Test_ZOR_Assignment</name>
        <label>Test ZOR Assignment</label>
        <locationX>50</locationX>
        <locationY>638</locationY>
        <assignmentItems>
            <assignToReference>slpParamsPoster</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>{ &quot;ocf_PARTNERS&quot;: { &quot;ocf_Payer&quot;: &quot;0001015827&quot;, &quot;ocf_BILLTO&quot;: &quot;0001015827&quot;, &quot;ocf_SHIPTO&quot;: &quot;0001002374&quot;, &quot;ocf_SOLDTO&quot;: &quot;0001002374&quot;, &quot;ovcInitialAccount&quot;: &quot;0001002374&quot; }, &quot;ORDER_HEADER_IN&quot;: { &quot;DOC_TYPE&quot;: &quot;ZOR&quot;, &quot;DIVISION&quot;: &quot;00&quot;, &quot;DISTR_CHAN&quot;: &quot;10&quot;, &quot;SALES_ORG&quot;: &quot;1000&quot; } }</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Redirect_to_Sales_Order_Poster</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>ZOR_type</name>
        <choiceText>ZOR : Basic Sales Order</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>ZOR</stringValue>
        </value>
    </choices>
    <choices>
        <name>ZQT_type</name>
        <choiceText>ZOR : Basic Sales Order with reference to Quotation</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>ZQT</stringValue>
        </value>
    </choices>
    <choices>
        <name>ZRE_type</name>
        <choiceText>ZRE : Sales Return with reference to Invoice</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>ZRE</stringValue>
        </value>
    </choices>
    <choices>
        <name>ZRET_type</name>
        <choiceText>ZRET : Sales Return without reference</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>ZRET</stringValue>
        </value>
    </choices>
    <constants>
        <name>DETAIL_COMPONENT_ZQT</name>
        <dataType>String</dataType>
        <value>
            <stringValue>sapSalesOrderDetailsQuote</stringValue>
        </value>
    </constants>
    <constants>
        <name>DETAIL_COMPONENT_ZRE</name>
        <dataType>String</dataType>
        <value>
            <stringValue>ovcSAPInvoiceDetailsZRE</stringValue>
        </value>
    </constants>
    <constants>
        <name>ZOR_SALES_ORDER_POSTER</name>
        <dataType>String</dataType>
        <value>
            <stringValue>SAPSalesOrderCreateZOR</stringValue>
        </value>
    </constants>
    <decisions>
        <name>Check_selected_document_type</name>
        <label>Check selected document type</label>
        <locationX>534</locationX>
        <locationY>518</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>ZOR_selected</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>choose_document_type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>ZOR_type</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Test_ZOR_Assignment</targetReference>
            </connector>
            <label>ZOR selected</label>
        </rules>
        <rules>
            <name>ZQT_selected</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>choose_document_type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>ZQT_type</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Run_Basic_Order_Creation_with_Quotation_reference</targetReference>
            </connector>
            <label>ZQT selected</label>
        </rules>
        <rules>
            <name>ZRE_selected</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>choose_document_type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>ZRE_type</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Validate_Invoice_for_ZRE_Sales_Return</targetReference>
            </connector>
            <label>ZRE selected</label>
        </rules>
        <rules>
            <name>ZRET_selected</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>choose_document_type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>ZRET_type</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Redirect_to_Sales_Order_Poster</targetReference>
            </connector>
            <label>ZRET selected</label>
        </rules>
    </decisions>
    <formulas>
        <name>detailComponentName</name>
        <dataType>String</dataType>
        <expression>IF ( {!ZRE_selected}, {!DETAIL_COMPONENT_ZRE}, IF ( {!ZQT_selected}, {!DETAIL_COMPONENT_ZQT} , &apos;&apos; ) )</expression>
    </formulas>
    <formulas>
        <name>posterMode</name>
        <dataType>String</dataType>
        <expression>IF ( OR ( {!ZRE_selected}, {!ZQT_selected} ), &apos;Clone&apos;, &apos;Create&apos; )</expression>
    </formulas>
    <interviewLabel>Case: Create SAP document {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Case: Create SAP document</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <screens>
        <name>Document_Type_Selection</name>
        <label>Document Type Selection</label>
        <locationX>534</locationX>
        <locationY>158</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Assign_selected_document_type</targetReference>
        </connector>
        <fields>
            <name>choose_document_type</name>
            <choiceReferences>ZOR_type</choiceReferences>
            <choiceReferences>ZQT_type</choiceReferences>
            <choiceReferences>ZRE_type</choiceReferences>
            <choiceReferences>ZRET_type</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Please choose the document type</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>408</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Document_Type_Selection</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>Run_Basic_Order_Creation_with_Quotation_reference</name>
        <label>Run Basic Order Creation with Quotation reference</label>
        <locationX>314</locationX>
        <locationY>638</locationY>
        <connector>
            <targetReference>Redirect_to_Sales_Order_Poster</targetReference>
        </connector>
        <flowName>Case_Create_Basic_Sales_Order_with_Reference_to_Quotation</flowName>
        <outputAssignments>
            <assignToReference>slpParamsDetail</assignToReference>
            <name>slpParamsSub</name>
        </outputAssignments>
    </subflows>
    <subflows>
        <name>Validate_Invoice_for_ZRE_Sales_Return</name>
        <label>Validate Invoice for ZRE Sales Return</label>
        <locationX>578</locationX>
        <locationY>638</locationY>
        <connector>
            <targetReference>Redirect_to_Sales_Order_Poster</targetReference>
        </connector>
        <flowName>Validate_Invoice_for_ZRE_Sales_Return</flowName>
        <outputAssignments>
            <assignToReference>slpParamsDetail</assignToReference>
            <name>slpParamsOutput</name>
        </outputAssignments>
    </subflows>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>selectedDocType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>slpParamsDetail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>slpParamsPoster</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
